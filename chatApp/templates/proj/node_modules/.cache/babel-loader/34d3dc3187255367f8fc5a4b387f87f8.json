{"ast":null,"code":"var _jsxFileName = \"E:\\\\Programming\\\\React\\\\For Merging Chat-App\\\\proj\\\\src\\\\containers\\\\Chat.js\";\nimport React from \"react\";\nimport { connect } from \"react-redux\";\nimport WebSocketInstance from \"../websocket\";\nimport Hoc from \"../hoc/hoc\";\nimport Profile from \"./Profile\";\n\nclass Chat extends React.Component {\n  initialiseChat() {\n    this.waitForSocketConnection(() => {\n      // WebSocketInstance.addCallbacks(\n      //   this.props.setMessages.bind(this),\n      //   this.props.addMessage.bind(this)\n      // );\n      WebSocketInstance.fetchMessages(this.props.username, this.props.match.params.chatID);\n    });\n    WebSocketInstance.connect(this.props.match.params.chatID);\n  }\n\n  constructor(props) {\n    super(props);\n    this.state = {\n      newText: '',\n      message: \"\"\n    };\n\n    this.messageChangeHandler = event => {\n      this.setState({\n        message: event.target.value\n      });\n    };\n\n    this.sendMessageHandler = e => {\n      e.preventDefault();\n      const messageObject = {\n        from: this.props.username,\n        content: this.state.message,\n        chatId: this.props.match.params.chatID\n      };\n      WebSocketInstance.newChatMessage(messageObject);\n      this.setState({\n        message: \"\"\n      });\n    };\n\n    this.renderTimestamp = timestamp => {\n      let prefix = \"\";\n      const timeDiff = Math.round((new Date().getTime() - new Date(timestamp).getTime()) / 60000);\n\n      if (timeDiff < 1) {\n        // less than one minute ago\n        prefix = \"just now...\";\n      } else if (timeDiff < 60 && timeDiff > 1) {\n        // less than sixty minutes ago\n        prefix = `${timeDiff} minutes ago`;\n      } else if (timeDiff < 24 * 60 && timeDiff > 60) {\n        // less than 24 hours ago\n        prefix = `${Math.round(timeDiff / 60)} hours ago`;\n      } else if (timeDiff < 31 * 24 * 60 && timeDiff > 24 * 60) {\n        // less than 7 days ago\n        prefix = `${Math.round(timeDiff / (60 * 24))} days ago`;\n      } else {}\n\n      return prefix;\n    };\n\n    this.getUserName = name => {\n      var index = name.lastIndexOf('@');\n      name = name.substr(0, index) + '    @' + name.substr(index + 1);\n      this.setState;\n      return name;\n    };\n\n    this.renderMessages = messages => {\n      const currentUser = this.props.username;\n      return messages.map((message, i, arr) => /*#__PURE__*/React.createElement(\"li\", {\n        key: message.id,\n        style: {\n          marginBottom: arr.length - 1 === i ? \"300px\" : \"15px\"\n        },\n        className: message.author === currentUser ? \"sent\" : \"replies\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"p\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 9\n        }\n      }, this.getUserName(message.content), /*#__PURE__*/React.createElement(\"br\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 100,\n          columnNumber: 11\n        }\n      }), /*#__PURE__*/React.createElement(\"small\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 101,\n          columnNumber: 11\n        }\n      }, this.renderTimestamp(message.timestamp)))));\n    };\n\n    this.scrollToBottom = () => {\n      this.messagesEnd.scrollIntoView({\n        behavior: \"smooth\"\n      });\n    };\n\n    this.initialiseChat();\n  }\n\n  waitForSocketConnection(callback) {\n    const component = this;\n    setTimeout(function () {\n      if (WebSocketInstance.state() === 1) {\n        console.log(\"Connection is made\");\n        callback();\n        return;\n      } else {\n        console.log(\"wait for connection...\");\n        component.waitForSocketConnection(callback);\n      }\n    }, 100);\n  }\n\n  componentDidMount() {\n    this.scrollToBottom();\n  }\n\n  componentDidUpdate() {\n    this.scrollToBottom();\n  }\n\n  componentWillReceiveProps(newProps) {\n    if (this.props.match.params.chatID !== newProps.match.params.chatID) {\n      WebSocketInstance.disconnect();\n      this.waitForSocketConnection(() => {\n        WebSocketInstance.fetchMessages(this.props.username, newProps.match.params.chatID);\n      });\n      WebSocketInstance.connect(newProps.match.params.chatID);\n    }\n  }\n\n  render() {\n    const messages = this.state.messages;\n    return /*#__PURE__*/React.createElement(Hoc, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 136,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(Profile, {\n      id: this.props.match.params.chatID,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"messages\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 138,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"ul\", {\n      id: \"chat-log\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 139,\n        columnNumber: 11\n      }\n    }, this.props.messages && this.renderMessages(this.props.messages), /*#__PURE__*/React.createElement(\"div\", {\n      style: {\n        float: \"left\",\n        clear: \"both\"\n      },\n      ref: el => {\n        this.messagesEnd = el;\n      },\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 13\n      }\n    }))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"message-input\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.sendMessageHandler,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"wrap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 151,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      onChange: this.messageChangeHandler,\n      value: this.state.message,\n      required: true,\n      id: \"chat-message-input\",\n      type: \"text\",\n      placeholder: \"Write your message...\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 15\n      }\n    }), /*#__PURE__*/React.createElement(\"button\", {\n      style: {\n        width: '90px',\n        paddingTop: '20px'\n      },\n      id: \"chat-message-submit\",\n      className: \"submit\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 161,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"i\", {\n      className: \"fa fa-paper-plane\",\n      \"aria-hidden\": \"true\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 162,\n        columnNumber: 17\n      }\n    }))))));\n  }\n\n}\n\nconst mapStateToProps = state => {\n  return {\n    username: state.auth.username,\n    messages: state.message.messages\n  };\n};\n\nexport default connect(mapStateToProps)(Chat);","map":{"version":3,"sources":["E:/Programming/React/For Merging Chat-App/proj/src/containers/Chat.js"],"names":["React","connect","WebSocketInstance","Hoc","Profile","Chat","Component","initialiseChat","waitForSocketConnection","fetchMessages","props","username","match","params","chatID","constructor","state","newText","message","messageChangeHandler","event","setState","target","value","sendMessageHandler","e","preventDefault","messageObject","from","content","chatId","newChatMessage","renderTimestamp","timestamp","prefix","timeDiff","Math","round","Date","getTime","getUserName","name","index","lastIndexOf","substr","renderMessages","messages","currentUser","map","i","arr","id","marginBottom","length","author","scrollToBottom","messagesEnd","scrollIntoView","behavior","callback","component","setTimeout","console","log","componentDidMount","componentDidUpdate","componentWillReceiveProps","newProps","disconnect","render","float","clear","el","width","paddingTop","mapStateToProps","auth"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport WebSocketInstance from \"../websocket\";\r\nimport Hoc from \"../hoc/hoc\";\r\nimport Profile from \"./Profile\";\r\n\r\nclass Chat extends React.Component {\r\n  state = {\r\n    newText:'',\r\n    message: \"\"\r\n  };\r\n\r\n  initialiseChat() {\r\n    this.waitForSocketConnection(() => {\r\n      // WebSocketInstance.addCallbacks(\r\n      //   this.props.setMessages.bind(this),\r\n      //   this.props.addMessage.bind(this)\r\n      // );\r\n      WebSocketInstance.fetchMessages(\r\n        this.props.username,\r\n        this.props.match.params.chatID\r\n      );\r\n    });\r\n    WebSocketInstance.connect(this.props.match.params.chatID);\r\n  }\r\n\r\n  constructor(props) {\r\n    super(props);\r\n    this.initialiseChat();\r\n  }\r\n\r\n  waitForSocketConnection(callback) {\r\n    const component = this;\r\n    setTimeout(function() {\r\n      if (WebSocketInstance.state() === 1) {\r\n        console.log(\"Connection is made\");\r\n        callback();\r\n        return;\r\n      } else {\r\n        console.log(\"wait for connection...\");\r\n        component.waitForSocketConnection(callback);\r\n      }\r\n    }, 100);\r\n  }\r\n\r\n  messageChangeHandler = event => {\r\n    this.setState({ message: event.target.value});\r\n  };\r\n\r\n  sendMessageHandler = e => {\r\n    e.preventDefault();\r\n    const messageObject = {\r\n      from: this.props.username,\r\n      content: this.state.message,\r\n      chatId: this.props.match.params.chatID\r\n    };\r\n    WebSocketInstance.newChatMessage(messageObject);\r\n    this.setState({ message: \"\" });\r\n  };\r\n\r\n  renderTimestamp = timestamp => {\r\n    let prefix = \"\";\r\n    const timeDiff = Math.round(\r\n      (new Date().getTime() - new Date(timestamp).getTime()) / 60000\r\n    );\r\n    if (timeDiff < 1) {\r\n      // less than one minute ago\r\n      prefix = \"just now...\";\r\n    } else if (timeDiff < 60 && timeDiff > 1) {\r\n      // less than sixty minutes ago\r\n      prefix = `${timeDiff} minutes ago`;\r\n    } else if (timeDiff < 24 * 60 && timeDiff > 60) {\r\n      // less than 24 hours ago\r\n      prefix = `${Math.round(timeDiff / 60)} hours ago`;\r\n    } else if (timeDiff < 31 * 24 * 60 && timeDiff > 24 * 60) {\r\n      // less than 7 days ago\r\n      prefix = `${Math.round(timeDiff / (60 * 24))} days ago`;\r\n    } else {\r\n\r\n    }\r\n    return prefix;\r\n  };\r\n\r\n  getUserName = (name) => {\r\n    var index = name.lastIndexOf('@')\r\n    name = name.substr(0, index) + '    @' + name.substr(index + 1);\r\n    this.setState\r\n    return name\r\n  }\r\n  renderMessages = messages => {\r\n    const currentUser = this.props.username;\r\n    return messages.map((message, i, arr) => (\r\n      <li\r\n        key={message.id}\r\n        style={{ marginBottom: arr.length - 1 === i ? \"300px\" : \"15px\" }}\r\n        className={message.author === currentUser ? \"sent\" : \"replies\"}\r\n      >\r\n        <p>\r\n          {this.getUserName(message.content)}\r\n          <br />\r\n          <small>{this.renderTimestamp(message.timestamp)}</small>\r\n        </p>\r\n      </li>\r\n    ));\r\n  };\r\n\r\n  scrollToBottom = () => {\r\n    this.messagesEnd.scrollIntoView({ behavior: \"smooth\" });\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.scrollToBottom();\r\n  }\r\n\r\n  componentDidUpdate() {\r\n    this.scrollToBottom();\r\n  }\r\n\r\n  componentWillReceiveProps(newProps) {\r\n    if (this.props.match.params.chatID !== newProps.match.params.chatID) {\r\n      WebSocketInstance.disconnect();\r\n      this.waitForSocketConnection(() => {\r\n        WebSocketInstance.fetchMessages(\r\n          this.props.username,\r\n          newProps.match.params.chatID\r\n        );\r\n      });\r\n      WebSocketInstance.connect(newProps.match.params.chatID);\r\n    }\r\n  }\r\n\r\n  render() {\r\n    const messages = this.state.messages;\r\n    return (\r\n\r\n      <Hoc>\r\n        <Profile  id={this.props.match.params.chatID} />\r\n        <div className=\"messages\">\r\n          <ul id=\"chat-log\">\r\n            {this.props.messages && this.renderMessages(this.props.messages)}\r\n            <div\r\n              style={{ float: \"left\", clear: \"both\" }}\r\n              ref={el => {\r\n                this.messagesEnd = el;\r\n              }}\r\n            />\r\n          </ul>\r\n        </div>\r\n        <div className=\"message-input\">\r\n          <form onSubmit={this.sendMessageHandler}>\r\n            <div className=\"wrap\">\r\n              <input\r\n                onChange={this.messageChangeHandler}\r\n                value={this.state.message}\r\n                required\r\n                id=\"chat-message-input\"\r\n                type=\"text\"\r\n                placeholder=\"Write your message...\"\r\n              />\r\n              {/* <i className=\"fa fa-paperclip attachment\" aria-hidden=\"true\" /> */}\r\n              <button style={{width:'90px',paddingTop:'20px'}} id=\"chat-message-submit\" className=\"submit\">\r\n                <i className=\"fa fa-paper-plane\" aria-hidden=\"true\" />\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </Hoc>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    username: state.auth.username,\r\n    messages: state.message.messages,\r\n\r\n  };\r\n};\r\n\r\nexport default connect(mapStateToProps)(Chat);\r\n"]},"metadata":{},"sourceType":"module"}