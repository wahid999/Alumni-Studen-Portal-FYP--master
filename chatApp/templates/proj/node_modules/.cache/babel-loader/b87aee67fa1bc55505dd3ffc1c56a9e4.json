{"ast":null,"code":"import _classCallCheck from\"E:\\\\Programming\\\\React\\\\For Merging Chat-App\\\\proj\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/classCallCheck\";import _createClass from\"E:\\\\Programming\\\\React\\\\For Merging Chat-App\\\\proj\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createClass\";import _inherits from\"E:\\\\Programming\\\\React\\\\For Merging Chat-App\\\\proj\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/inherits\";import _createSuper from\"E:\\\\Programming\\\\React\\\\For Merging Chat-App\\\\proj\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/createSuper\";import axios from\"axios\";import React from\"react\";import{Spin,Icon}from\"antd\";import{connect}from\"react-redux\";import*as actions from\"../store/actions/auth\";import*as navActions from\"../store/actions/nav\";import*as messageActions from\"../store/actions/message\";import Contact from\"../components/Contact\";import'./../assets/style.css';import groupUser from'./../assets/groupUser.png';import singleUser from'./../assets/singleUser.png';var antIcon=/*#__PURE__*/React.createElement(Icon,{type:\"loading\",style:{fontSize:24},spin:true});var Sidepanel=/*#__PURE__*/function(_React$Component){_inherits(Sidepanel,_React$Component);var _super=_createSuper(Sidepanel);function Sidepanel(){var _this;_classCallCheck(this,Sidepanel);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.picFlag='';_this.state={loginForm:true,chat:{},value:'',picFlag:''};_this.getImage=function(){var username=localStorage.getItem('username');var token=localStorage.getItem('token');axios.defaults.headers={\"Content-Type\":\"application/json\",Authorization:\"Token \".concat(token)};axios.get(\"http://127.0.0.1:8000/chat/profile/\".concat(username,\"/\")).then(function(res){return res.data;}).then(function(res){if(res.length!==0)_this.setState({value:res[0].photo_url});else{_this.setState({value:singleUser});}});};_this.changeForm=function(){_this.setState({loginForm:!_this.state.loginForm});};_this.authenticate=function(e){e.preventDefault();if(_this.state.loginForm){_this.props.login(e.target.username.value,e.target.password.value);}else{_this.props.signup(e.target.username.value,e.target.email.value,e.target.password.value,e.target.password2.value);}};_this.getUsername=function(){var getUser=localStorage.getItem('username');if(getUser!==undefined&&getUser!==null){var name=getUser.charAt(0).toUpperCase()+getUser.slice(1);return name;}};return _this;}_createClass(Sidepanel,[{key:\"waitForAuthDetails\",value:function waitForAuthDetails(){var component=this;setTimeout(function(){if(component.props.token!==null&&component.props.token!==undefined){component.props.getUserChats(component.props.username,component.props.token);return;}else{console.log(\"waiting for authentication details...\");component.waitForAuthDetails();}},100);}},{key:\"componentDidMount\",value:function componentDidMount(){this.waitForAuthDetails();}},{key:\"openAddChatPopup\",value:function openAddChatPopup(){this.props.addChat();}},{key:\"render\",value:function render(){var _this2=this;var activeChats=this.props.chats.map(function(c){return/*#__PURE__*/React.createElement(Contact,{key:c.id,id:c.id,name:c.participants,status:\"busy\",chatURL:\"\".concat(c.memebers_name)});});return/*#__PURE__*/React.createElement(\"div\",{id:\"sidepanel\"},/*#__PURE__*/React.createElement(\"div\",{id:\"profile\"},/*#__PURE__*/React.createElement(\"div\",{className:\"wrap\"},localStorage.getItem('username')===null?/*#__PURE__*/React.createElement(\"p\",{style:{fontSize:'18px'}},\"Enter Login info here\"):/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"img\",{id:\"profile-img\",src:this.state.value,className:\"online\",alt:\"\"}),this.getImage()),/*#__PURE__*/React.createElement(\"p\",{style:{fontSize:'25px'}},this.getUsername()),/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-chevron-down expand-button\",\"aria-hidden\":\"true\"}),/*#__PURE__*/React.createElement(\"div\",{id:\"status-options\"},/*#__PURE__*/React.createElement(\"ul\",null,/*#__PURE__*/React.createElement(\"li\",{id:\"status-online\",className:\"active\"},/*#__PURE__*/React.createElement(\"span\",{className:\"status-circle\"}),\" \",/*#__PURE__*/React.createElement(\"p\",null,\"Online\")),/*#__PURE__*/React.createElement(\"li\",{id:\"status-away\"},/*#__PURE__*/React.createElement(\"span\",{className:\"status-circle\"}),\" \",/*#__PURE__*/React.createElement(\"p\",null,\"Away\")),/*#__PURE__*/React.createElement(\"li\",{id:\"status-busy\"},/*#__PURE__*/React.createElement(\"span\",{className:\"status-circle\"}),\" \",/*#__PURE__*/React.createElement(\"p\",null,\"Busy\")),/*#__PURE__*/React.createElement(\"li\",{id:\"status-offline\"},/*#__PURE__*/React.createElement(\"span\",{className:\"status-circle\"}),\" \",/*#__PURE__*/React.createElement(\"p\",null,\"Offline\")))),/*#__PURE__*/React.createElement(\"div\",{id:\"expanded\"},this.props.loading?/*#__PURE__*/React.createElement(Spin,{indicator:antIcon}):this.props.isAuthenticated?/*#__PURE__*/React.createElement(\"button\",{onClick:function onClick(){window.location.replace('/');_this2.props.logout();},className:\"btnTry\"},/*#__PURE__*/React.createElement(\"span\",{className:\"btnTry\"},\"Logout\")):/*#__PURE__*/React.createElement(\"div\",{style:{fontSize:'15px'}},/*#__PURE__*/React.createElement(\"form\",{method:\"POST\",onSubmit:this.authenticate},this.state.loginForm?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"input\",{name:\"username\",type:\"text\",placeholder:\"username\"}),/*#__PURE__*/React.createElement(\"input\",{name:\"password\",type:\"password\",placeholder:\"password\"})):/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"input\",{name:\"username\",type:\"text\",placeholder:\"username\"}),/*#__PURE__*/React.createElement(\"input\",{name:\"email\",type:\"email\",placeholder:\"email\"}),/*#__PURE__*/React.createElement(\"input\",{name:\"password\",type:\"password\",placeholder:\"password\"}),/*#__PURE__*/React.createElement(\"input\",{name:\"password2\",type:\"password\",placeholder:\"password confirm\"})),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},\"Authenticate\"))),this.props.error!==null?/*#__PURE__*/React.createElement(\"p\",{style:{fontSize:'15px'}},\"Wrong Username or Password..!\"):/*#__PURE__*/React.createElement(\"p\",null),/*#__PURE__*/React.createElement(\"hr\",{style:{marginTop:'90px',marginRight:'20px'}})),/*#__PURE__*/React.createElement(\"div\",{style:{marginBottom:'200px'},id:\"contacts\"},/*#__PURE__*/React.createElement(\"ul\",null,activeChats)))),localStorage.getItem('username')===null?/*#__PURE__*/React.createElement(\"p\",null):/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",{id:\"bottom-bar\",style:{marginTop:'200px'}},/*#__PURE__*/React.createElement(\"button\",{id:\"addChat\",style:{width:'100%',fontSize:'15px'},onClick:function onClick(){return _this2.openAddChatPopup();}},/*#__PURE__*/React.createElement(\"i\",{className:\"fa fa-user-plus fa-fw\",\"aria-hidden\":\"true\"}),/*#__PURE__*/React.createElement(\"span\",null,\"Create chat\")))));}}]);return Sidepanel;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{isAuthenticated:state.auth.token!==null,loading:state.auth.loading,token:state.auth.token,username:state.auth.username,chats:state.message.chats,error:state.auth.error};};var mapDispatchToProps=function mapDispatchToProps(dispatch){return{login:function login(userName,password){return(// dispatch(actions.authLogin(localStorage.getItem('name'), localStorage.getItem('password'))),\ndispatch(actions.authLogin(userName,password)));},logout:function logout(){return dispatch(actions.logout());},signup:function signup(username,email,password1,password2){return dispatch(actions.authSignup(username,email,password1,password2));},addChat:function addChat(){return dispatch(navActions.openAddChatPopup());},getUserChats:function getUserChats(username,token){return dispatch(messageActions.getUserChats(username,token));}};};export default connect(mapStateToProps,mapDispatchToProps)(Sidepanel);","map":{"version":3,"sources":["E:/Programming/React/For Merging Chat-App/proj/src/containers/Sidepanel.js"],"names":["axios","React","Spin","Icon","connect","actions","navActions","messageActions","Contact","groupUser","singleUser","antIcon","fontSize","Sidepanel","picFlag","state","loginForm","chat","value","getImage","username","localStorage","getItem","token","defaults","headers","Authorization","get","then","res","data","length","setState","photo_url","changeForm","authenticate","e","preventDefault","props","login","target","password","signup","email","password2","getUsername","getUser","undefined","name","charAt","toUpperCase","slice","component","setTimeout","getUserChats","console","log","waitForAuthDetails","addChat","activeChats","chats","map","c","id","participants","memebers_name","loading","isAuthenticated","window","location","replace","logout","error","marginTop","marginRight","marginBottom","width","openAddChatPopup","Component","mapStateToProps","auth","message","mapDispatchToProps","dispatch","userName","authLogin","password1","authSignup"],"mappings":"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","sourcesContent":["import axios from \"axios\";\r\nimport React from \"react\";\r\nimport { Spin, Icon } from \"antd\";\r\nimport { connect } from \"react-redux\";\r\nimport * as actions from \"../store/actions/auth\";\r\nimport * as navActions from \"../store/actions/nav\";\r\nimport * as messageActions from \"../store/actions/message\";\r\nimport Contact from \"../components/Contact\";\r\nimport './../assets/style.css'\r\nimport groupUser from './../assets/groupUser.png'\r\nimport singleUser from './../assets/singleUser.png'\r\nconst antIcon = <Icon type=\"loading\" style={{ fontSize: 24 }} spin />;\r\n\r\nclass Sidepanel extends React.Component {\r\n  picFlag = ''\r\n  \r\n  state = {\r\n    loginForm: true,\r\n    chat: {},\r\n    value: '',\r\n    picFlag:''\r\n    \r\n  };\r\n \r\n  getImage = () => {\r\n    var username = localStorage.getItem('username')\r\n\r\n    var token=localStorage.getItem('token')\r\n    axios.defaults.headers = {\r\n    \"Content-Type\": \"application/json\",\r\n    Authorization: `Token ${token}`\r\n    };\r\n    axios\r\n      .get(`http://127.0.0.1:8000/chat/profile/${username}/`)\r\n      .then(res => res.data)\r\n      .then(res => {\r\n        if(res.length!==0)\r\n          this.setState({ value: (res[0].photo_url) })\r\n        else{this.setState({value:singleUser})}\r\n      })\r\n   \r\n  }\r\n\r\n  waitForAuthDetails() {\r\n    const component = this;\r\n    setTimeout(function () {\r\n      if (\r\n        component.props.token !== null &&\r\n        component.props.token !== undefined\r\n      ) {\r\n        component.props.getUserChats(\r\n          component.props.username,\r\n          component.props.token\r\n        );\r\n        return;\r\n      } else {\r\n        console.log(\"waiting for authentication details...\");\r\n        component.waitForAuthDetails();\r\n      }\r\n    }, 100);\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.waitForAuthDetails();\r\n  }\r\n\r\n  \r\n  openAddChatPopup() {\r\n    this.props.addChat();\r\n  }\r\n\r\n  changeForm = () => {\r\n    this.setState({ loginForm: !this.state.loginForm });\r\n  };\r\n\r\n  authenticate = e => {\r\n    e.preventDefault();\r\n    if (this.state.loginForm) {\r\n      this.props.login(e.target.username.value, e.target.password.value);\r\n    } else {\r\n      this.props.signup(\r\n        e.target.username.value,\r\n        e.target.email.value,\r\n        e.target.password.value,\r\n        e.target.password2.value\r\n      );\r\n    }\r\n  };\r\n\r\n  getUsername = () => {\r\n    var getUser = localStorage.getItem('username')\r\n    \r\n    if (getUser !== undefined && getUser !== null) {\r\n      var name = getUser.charAt(0).toUpperCase() + getUser.slice(1)\r\n      return name\r\n    }\r\n\r\n  }\r\n\r\n \r\n  render() {\r\n    let activeChats = this.props.chats.map(c => {\r\n      \r\n      return (\r\n          \r\n          <Contact\r\n            key={c.id}\r\n            id={c.id}\r\n            name={c.participants}\r\n            status=\"busy\"\r\n            chatURL={`${c.memebers_name}`}\r\n            />          \r\n      );\r\n    } );\r\n    return (\r\n      <div id=\"sidepanel\">\r\n        <div id=\"profile\"  >\r\n          <div className=\"wrap\" >\r\n            \r\n            {\r\n              localStorage.getItem('username') === null ?\r\n                <p style={{ fontSize: '18px' }}>Enter Login info here</p> :\r\n                <div>\r\n                  \r\n                <img\r\n                  id=\"profile-img\"\r\n                  src={this.state.value}\r\n                  className=\"online\"\r\n                  alt=\"\"    \r\n                  />\r\n                {this.getImage()}\r\n                </div>\r\n\r\n            }\r\n            \r\n            <p style={{fontSize:'25px'}}>{this.getUsername()}</p>\r\n            <i\r\n              className=\"fa fa-chevron-down expand-button\"\r\n              aria-hidden=\"true\"\r\n            />\r\n            <div id=\"status-options\">\r\n              <ul>\r\n                <li id=\"status-online\" className=\"active\">\r\n                  <span className=\"status-circle\" /> <p>Online</p>\r\n                </li>\r\n                <li id=\"status-away\">\r\n                  <span className=\"status-circle\" /> <p>Away</p>\r\n                </li>\r\n                <li id=\"status-busy\">\r\n                  <span className=\"status-circle\" /> <p>Busy</p>\r\n                </li>\r\n                <li id=\"status-offline\">\r\n                  <span className=\"status-circle\" /> <p>Offline</p>\r\n                </li>\r\n              </ul>\r\n            </div>\r\n            <div id=\"expanded\">\r\n              {this.props.loading ? (\r\n                <Spin indicator={antIcon} />\r\n              ) : this.props.isAuthenticated ? (\r\n                  <button onClick={() => {\r\n                      window.location.replace('/')\r\n                    this.props.logout()\r\n                  }} className=\"btnTry\">\r\n                  <span className='btnTry'>Logout</span>\r\n                </button>\r\n              ) : (\r\n                <div style={{fontSize:'15px'}}>\r\n                  <form method=\"POST\" onSubmit={this.authenticate}>\r\n                    {this.state.loginForm ? (\r\n                      <div>\r\n                        <input\r\n                          name=\"username\"\r\n                          type=\"text\"\r\n                          placeholder=\"username\"\r\n                        />\r\n                        <input\r\n                          name=\"password\"\r\n                          type=\"password\"\r\n                          placeholder=\"password\"\r\n                        />\r\n                      </div>\r\n                    ) : (\r\n                      <div>\r\n                        <input\r\n                          name=\"username\"\r\n                          type=\"text\"\r\n                          placeholder=\"username\"\r\n                        />\r\n                        <input name=\"email\" type=\"email\" placeholder=\"email\" />\r\n                        <input\r\n                          name=\"password\"\r\n                          type=\"password\"\r\n                          placeholder=\"password\"\r\n                        />\r\n                        <input\r\n                          name=\"password2\"\r\n                          type=\"password\"\r\n                          placeholder=\"password confirm\"\r\n                        />\r\n                      </div>\r\n                    )}\r\n\r\n                        <button type=\"submit\"  >Authenticate</button>\r\n                  </form>\r\n\r\n                </div>\r\n                  )}\r\n              \r\n              {this.props.error!==null?<p style={{fontSize:'15px'}}>Wrong Username or Password..!</p>:<p></p>}\r\n              <hr style={{marginTop:'90px',marginRight:'20px'}}/>\r\n            </div>\r\n            <div  style={{marginBottom:'200px'}} id=\"contacts\">\r\n            <ul >{activeChats}</ul>\r\n\r\n       \r\n              </div>\r\n          </div>\r\n        </div>\r\n        \r\n        \r\n        {\r\n          localStorage.getItem('username') === null ? <p></p> :\r\n            <div >\r\n              {/* <div  id=\"contacts\">\r\n                 <ul >{activeChats}</ul>\r\n              </div> */}\r\n            <div id=\"bottom-bar\" style={{marginTop:'200px'}} >\r\n              <button id=\"addChat\" style={{width:'100%',fontSize:'15px'}} onClick={() => this.openAddChatPopup()}>\r\n                <i className=\"fa fa-user-plus fa-fw\" aria-hidden=\"true\" />\r\n                <span>Create chat</span>\r\n              </button>\r\n              \r\n              </div>\r\n              </div>\r\n        }\r\n        \r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapStateToProps = state => {\r\n  return {\r\n    isAuthenticated: state.auth.token !== null,\r\n    loading: state.auth.loading,\r\n    token: state.auth.token,\r\n    username: state.auth.username,\r\n    chats: state.message.chats,\r\n    error:state.auth.error\r\n  };\r\n};\r\n\r\nconst mapDispatchToProps = dispatch => {\r\n  return {\r\n    login: (userName, password) =>\r\n      // dispatch(actions.authLogin(localStorage.getItem('name'), localStorage.getItem('password'))),\r\n      dispatch(actions.authLogin(userName, password)),\r\n    logout: () => dispatch(actions.logout()),\r\n    signup: (username, email, password1, password2) =>\r\n      dispatch(actions.authSignup(username, email, password1, password2)),\r\n    addChat: () => dispatch(navActions.openAddChatPopup()),\r\n    getUserChats: (username, token) =>\r\n      dispatch(messageActions.getUserChats(username, token))\r\n  };\r\n};\r\n\r\nexport default connect(\r\n  mapStateToProps,\r\n  mapDispatchToProps\r\n)(Sidepanel);\r\n"]},"metadata":{},"sourceType":"module"}